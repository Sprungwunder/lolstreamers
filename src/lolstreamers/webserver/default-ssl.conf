<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName searchtherift.com
    ServerAlias www.searchtherift.com
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html


    # Add host filtering
    RewriteEngine On
    RewriteCond %{HTTP_HOST} !^(searchtherift\.com|www\.searchtherift\.com)$ [NC]
    RewriteRule ^ - [F,L]

    # SSL Configuration
    SSLEngine on
    # Replace these paths with your actual certificate file paths
    SSLCertificateFile      /etc/ssl/certs/searchtherift.crt
    SSLCertificateKeyFile   /etc/ssl/private/searchtherift.key
    # If you have a certificate chain file
    SSLCertificateChainFile /etc/ssl/certs/searchtherift-chain.crt

    # Your existing proxy configurations
    <Location /kibana>
        ProxyPass         http://localhost:5601 retry=0
        ProxyPassReverse  http://localhost:5601
    </Location>

    ProxyPreserveHost On
    ProxyPass / http://localhost:8081/
    ProxyPassReverse / http://localhost:8081/

    <Location /api>
        ProxyPass http://localhost:8000
        ProxyPassReverse http://localhost:8000
    </Location>

    ProxyPass /admin/ http://localhost:8000/admin/
    ProxyPassReverse /admin/ http://localhost:8000/admin/

    ProxyPass /static/ http://localhost:8000/static/
    ProxyPassReverse /static/ http://localhost:8000/static/

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
</IfModule>
