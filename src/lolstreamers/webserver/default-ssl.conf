<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName searchtherift.com
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html


    # Add host filtering
    RewriteEngine On
    RewriteCond %{HTTP_HOST} !^(searchtherift\.com|www\.searchtherift\.com|195\.90\.208\.42)$ [NC]
    RewriteRule ^ - [F,L]

    # SSL Configuration
    SSLEngine on
    # Updated paths to Let's Encrypt certificates
    SSLCertificateFile      /etc/letsencrypt/live/searchtherift.com/fullchain.pem
    SSLCertificateKeyFile   /etc/letsencrypt/live/searchtherift.com/privkey.pem

    # Shared reverse proxy routes
    Include conf-available/searchtherift-proxy.conf

    # Dedicated logs (+ split /kibana)
    Include conf-available/searchtherift-logging.conf
</VirtualHost>

<VirtualHost *:443>
    ServerName www.searchtherift.com
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html

    # SSL (certificate must include SAN for www)
    SSLEngine on
    SSLCertificateFile      /etc/letsencrypt/live/searchtherift.com/fullchain.pem
    SSLCertificateKeyFile   /etc/letsencrypt/live/searchtherift.com/privkey.pem

    # Shared reverse proxy routes
    Include conf-available/searchtherift-proxy.conf

    # Dedicated logs (+ split /kibana)
    Include conf-available/searchtherift-logging.conf
</VirtualHost>
</IfModule>
